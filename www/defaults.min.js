/*!  CyTube Enhancements: Room Defaults
**|  Version: 2024.06.03
**@preserve
*/ "use strict";if(void 0===CB)var CB={};if(void 0===UPDATE_CSS)var UPDATE_CSS=!0;if(void 0===UPDATE_EMOTES)var UPDATE_EMOTES=!0;if(void 0===UPDATE_FILTERS)var UPDATE_FILTERS=!0;if(void 0===UPDATE_JS)var UPDATE_JS=!0;if(void 0===UPDATE_MOTD)var UPDATE_MOTD=!0;if(void 0===UPDATE_OPTIONS)var UPDATE_OPTIONS=!0;if(void 0===UPDATE_PERMISSIONS)var UPDATE_PERMISSIONS=!0;const BlockerCSS_URL=Base_URL+"blocker.css",Emotes_URL=Root_URL+"emoji/emoji.json",Filters1_URL=Base_URL+"filters.json",Filters2_URL=Room_URL+"filters.json",JS_URL=Room_URL+"JS_Editor.js",MOTD_URL=Room_URL+"motd.html",Options_URL=Base_URL+"options.json",Permissions_URL=Base_URL+"permissions.json";CB.getOptions=function(){$.getJSON(Options_URL,function(t){logTrace("defaults.getOptions",t),window.socket.emit("setOptions",t)}).fail(function(t){errorData("defaults.getOptions Error",t.status+": "+t.statusText)})},CB.getPermissions=function(){$.getJSON(Permissions_URL,function(t){logTrace("defaults.getPermissions",t),window.socket.emit("setPermissions",t)}).fail(function(t){errorData("defaults.getPermissions Error",t.status+": "+t.statusText)})},CB.getEmotes=function(){$.getJSON(Emotes_URL,function(t){logTrace("defaults.getEmotes",t),window.socket.emit("importEmotes",t)}).fail(function(t){errorData("defaults.getEmotes Error",t.status+": "+t.statusText)})},CB.getMOTD=function(){$.ajax({url:MOTD_URL,datatype:"html",cache:!1,error:function(t){errorData("defaults.getMOTD Error",t.status+": "+t.statusText)},success:function(t){logTrace("defaults.getMOTD",t),window.socket.emit("setMotd",{motd:t})}}),setMOTDmessage()},CB.getBot=function(){window.socket.once("channelRanks",function(t){let e=-1;$.each(t,function(t,s){s.name.toLowerCase()===BOT_NICK.toLowerCase()&&(e=s.rank)}),window.CLIENT.rank>window.Rank.Admin&&e<window.Rank.Admin&&window.socket.emit("setChannelRank",{name:BOT_NICK,rank:window.Rank.Admin})}),window.socket.emit("requestChannelRanks")},CB.getCSS=function(){let t="",e="";function s(){if(AGE_RESTRICT&&t.length<1||e.length<1)return;let s=e;AGE_RESTRICT&&(s+=t),logTrace("defaults.getCSS.setCustomCSS",s),window.socket.emit("setChannelCSS",{css:s})}AGE_RESTRICT&&$.ajax({url:BlockerCSS_URL,datatype:"text",async:!1,cache:!1,error:function(t){errorData("defaults.getBlockerCSS Error",t.status+": "+t.statusText)},success:function(e){logTrace("defaults.getBlockerCSS",e),t=e,s()}}),$.ajax({url:CustomCSS_URL,datatype:"text",async:!1,cache:!1,error:function(t){errorData("defaults.getCustomCSS Error",t.status+": "+t.statusText)},success:function(t){logTrace("defaults.getCustomCSS",t),e=t,s()}})},CB.getJavascript=function(){$.ajax({url:JS_URL,datatype:"script",async:!1,cache:!1,crossDomain:!0,error:function(t){errorData("defaults.getJavascript Error",t.status+": "+t.statusText)},success:function(t){t!==CHANNEL.js&&(logTrace("defaults.getJavascript",t),window.socket.emit("setChannelJS",{js:t}),setTimeout(function(){errorData("defaults.getJavascript","RELOAD"),location.reload(!0)},1e4))}})},CB.getFilters=function(){var t=[Filters1_URL,Filters2_URL,],e=0,s=[],n=[];for(let i=0;i<t.length;i++)n.push($.ajax({url:t[i],datatype:"json",timeout:500,cache:!1}));function o(n){if(s.push(n),!(++e<t.length)){var i=[];s.forEach(function(t){i=i.concat(t.filter(t=>!JSON.stringify(i).includes(JSON.stringify(t))))}),logTrace("defaults.getFilters",JSON.stringify(i)),window.socket.emit("importFilters",i)}}$.when(n).always(function(){$.each(n,function(t){this.done(function(t){o(t)}).fail(function(t){o([])})})})},$(document).ready(function(){CB.getBot(),UPDATE_JS&&CB.getJavascript(),UPDATE_OPTIONS&&CB.getOptions(),UPDATE_PERMISSIONS&&CB.getPermissions(),UPDATE_CSS&&CB.getCSS(),UPDATE_MOTD&&CB.getMOTD(),UPDATE_EMOTES&&CB.getEmotes(),UPDATE_FILTERS&&CB.getFilters()});